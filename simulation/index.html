<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PKCS#1 v1.5 RSA Encryption/Decryption Simulation</title>
    <link rel="stylesheet" href="css/main.css" />
  </head>
  <body onload="do_init();">
    <div class="content">
      <h3>PKCS#1 v1.5 RSA Encryption/Decryption Simulation</h3>

      <form name="rsatest" onsubmit="do_encrypt();return false;">
        <!-- Input Section -->
        <div class="results">
          <h4>Step 1: Message Encryption/Decryption</h4>

          <table style="width: 100%">
            <tr>
              <td><strong>Plaintext to encrypt:</strong></td>
              <td>
                <input
                  id="plaintext"
                  name="plaintext"
                  size="60"
                  type="text"
                  value="Hello World!"
                  placeholder="Enter your message here..."
                  style="width: 100%"
                />
              </td>
              <td>
                <input
                  onclick="do_encrypt();"
                  type="button"
                  value="ðŸ”’ Encrypt"
                  style="
                    background: #28a745;
                    color: white;
                    border: none;
                    padding: 10px 15px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin: 5px;
                  "
                />
              </td>
            </tr>
            <tr>
              <td><strong>Ciphertext (hex):</strong></td>
              <td>
                <textarea
                  id="ciphertext"
                  name="ciphertext"
                  rows="4"
                  cols="70"
                  placeholder="Encrypted data will appear here..."
                  style="width: 100%; font-family: monospace"
                ></textarea>
              </td>
              <td>
                <input
                  onclick="do_decrypt();"
                  type="button"
                  value="ðŸ”“ Decrypt"
                  style="
                    background: #fd7e14;
                    color: white;
                    border: none;
                    padding: 10px 15px;
                    border-radius: 4px;
                    cursor: pointer;
                    margin: 5px;
                  "
                />
              </td>
            </tr>
            <tr>
              <td><strong>Decrypted text:</strong></td>
              <td>
                <input
                  id="decrypted"
                  name="decrypted"
                  size="60"
                  type="text"
                  placeholder="Decrypted message will appear here..."
                  style="width: 100%"
                />
              </td>
              <td></td>
            </tr>
            <tr>
              <td><strong>Status:</strong></td>
              <td>
                <input
                  id="status"
                  name="status"
                  size="60"
                  type="text"
                  readonly
                  value="Ready for encryption/decryption"
                  style="
                    width: 100%;
                    background-color: #f0f0f0;
                    font-weight: bold;
                  "
                />
              </td>
              <td></td>
            </tr>
          </table>
        </div>

        <!-- RSA Key Management Section -->
        <div class="key-section">
          <h4>Step 2: RSA Key Management</h4>
          <p><strong>Choose a preset key or generate a new one:</strong></p>

          <div style="margin: 10px 0">
            <input
              onclick="set_1024f4();"
              type="button"
              value="1024-bit Key (e=65537)"
              style="
                background: #28a745;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
              "
            />
            <input
              onclick="set_1024e3();"
              type="button"
              value="1024-bit Key (e=3)"
              style="
                background: #fd7e14;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
              "
            />
            <input
              onclick="set_512f4();"
              type="button"
              value="512-bit Key (e=65537)"
              style="
                background: #dc3545;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
              "
            />
            <input
              onclick="set_512e3();"
              type="button"
              value="512-bit Key (e=3)"
              style="
                background: #6f42c1;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
              "
            />
          </div>

          <div style="margin: 10px 0">
            <input
              onclick="do_genrsa();"
              type="button"
              value="ðŸ”‘ Generate New Key"
              style="
                background: #17a2b8;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
              "
            />
            <label for="bits" style="margin-left: 15px"
              >Key size (bits):
            </label>
            <input
              id="bits"
              name="bits"
              size="10"
              type="text"
              value="512"
              style="padding: 8px; border: 1px solid #ccc; border-radius: 3px"
            />
          </div>

          <h5>RSA Key Parameters</h5>
          <table style="width: 100%">
            <tr>
              <td><strong>Modulus (hex):</strong></td>
              <td>
                <textarea
                  id="n"
                  name="n"
                  rows="4"
                  cols="70"
                  placeholder="RSA modulus will appear here..."
                  style="width: 100%; font-family: monospace"
                ></textarea>
              </td>
              <td></td>
            </tr>
            <tr>
              <td>
                <strong>Public exponent (hex):</strong><br /><small
                  >(F4=0x10001)</small
                >
              </td>
              <td>
                <input
                  id="e"
                  name="e"
                  size="20"
                  type="text"
                  value="10001"
                  style="width: 100%; font-family: monospace"
                />
              </td>
              <td></td>
            </tr>
            <tr>
              <td><strong>Private exponent (hex):</strong></td>
              <td>
                <textarea
                  id="d"
                  name="d"
                  rows="4"
                  cols="70"
                  placeholder="Private exponent will appear here..."
                  style="width: 100%; font-family: monospace"
                ></textarea>
              </td>
              <td></td>
            </tr>
          </table>

          <details>
            <summary>
              <strong>Advanced Key Parameters (Click to expand)</strong>
            </summary>
            <table style="width: 100%; margin-top: 10px">
              <tr>
                <td><strong>P (hex):</strong></td>
                <td>
                  <textarea
                    id="p"
                    name="p"
                    rows="2"
                    cols="70"
                    placeholder="Prime factor P will appear here..."
                    style="width: 100%; font-family: monospace"
                  ></textarea>
                </td>
                <td></td>
              </tr>
              <tr>
                <td><strong>Q (hex):</strong></td>
                <td>
                  <textarea
                    id="q"
                    name="q"
                    rows="2"
                    cols="70"
                    placeholder="Prime factor Q will appear here..."
                    style="width: 100%; font-family: monospace"
                  ></textarea>
                </td>
                <td></td>
              </tr>
              <tr>
                <td><strong>D mod (P-1) (hex):</strong></td>
                <td>
                  <textarea
                    id="dmp1"
                    name="dmp1"
                    rows="2"
                    cols="70"
                    placeholder="D mod (P-1) will appear here..."
                    style="width: 100%; font-family: monospace"
                  ></textarea>
                </td>
                <td></td>
              </tr>
              <tr>
                <td><strong>D mod (Q-1) (hex):</strong></td>
                <td>
                  <textarea
                    id="dmq1"
                    name="dmq1"
                    rows="2"
                    cols="70"
                    placeholder="D mod (Q-1) will appear here..."
                    style="width: 100%; font-family: monospace"
                  ></textarea>
                </td>
                <td></td>
              </tr>
              <tr>
                <td><strong>1/Q mod P (hex):</strong></td>
                <td>
                  <textarea
                    id="coeff"
                    name="coeff"
                    rows="2"
                    cols="70"
                    placeholder="Coefficient will appear here..."
                    style="width: 100%; font-family: monospace"
                  ></textarea>
                </td>
                <td></td>
              </tr>
            </table>
          </details>
        </div>
      </form>
    </div>

    <!-- JavaScript Files -->
    <script
      language="JavaScript"
      src="js/mobile-detection.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/base64.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/jsbn.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/jsbn2.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/prng4.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/rng.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/rsa.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/rsa2.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/pkcs.js"
      type="text/javascript"
    ></script>
  <script src="../assets/js/iframeResize.js"></script>
        
        </body>
</html>
