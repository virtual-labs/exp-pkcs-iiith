<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PKCS#1 v1.5 RSA Encryption/Decryption Simulation</title>
    <link rel="stylesheet" href="css/main.css" />
  </head>
  <body onload="do_init();">
    <div class="container">
      <h2>PKCS#1 v1.5 RSA Encryption/Decryption Simulation</h2>

      <form name="rsatest" onsubmit="do_encrypt();return false;">
        <!-- Input Section -->
        <div class="results">
          <h3>Step 1: Enter Your Message</h3>
          <p>
            <label for="plaintext">Plaintext to encrypt:</label><br />
            <input
              id="plaintext"
              name="plaintext"
              size="60"
              type="text"
              value="Hello World!"
              placeholder="Enter your message here..."
            />
          </p>

          <div style="text-align: center; margin: 20px 0">
            <input onclick="do_encrypt();" type="button" value="ðŸ”’ Encrypt" />
            <input onclick="do_decrypt();" type="button" value="ðŸ”“ Decrypt" />
          </div>

          <p>
            <label for="ciphertext">Ciphertext (hex):</label><br />
            <textarea
              id="ciphertext"
              name="ciphertext"
              rows="4"
              cols="70"
              placeholder="Encrypted data will appear here..."
            ></textarea>
          </p>

          <p>
            <label for="decrypted">Decrypted text:</label><br />
            <input
              id="decrypted"
              name="decrypted"
              size="60"
              type="text"
              placeholder="Decrypted message will appear here..."
            />
          </p>

          <p>
            <label for="status">Status:</label><br />
            <input
              id="status"
              name="status"
              size="60"
              type="text"
              readonly
              value="Ready for encryption/decryption"
            />
          </p>
        </div>

        <!-- RSA Key Management Section -->
        <div class="key-section">
          <h3>Step 2: RSA Key Management</h3>
          <p><strong>Choose a preset key or generate a new one:</strong></p>

          <div class="key-buttons">
            <input
              onclick="set_1024f4();"
              type="button"
              value="1024-bit Key (e=65537)"
            />
            <input
              onclick="set_1024e3();"
              type="button"
              value="1024-bit Key (e=3)"
            />
            <input
              onclick="set_512f4();"
              type="button"
              value="512-bit Key (e=65537)"
            />
            <input
              onclick="set_512e3();"
              type="button"
              value="512-bit Key (e=3)"
            />
            <input
              onclick="do_genrsa();"
              type="button"
              value="ðŸ”‘ Generate New Key"
            />
            <label for="bits">Key size (bits): </label>
            <input id="bits" name="bits" size="10" type="text" value="512" />
          </div>

          <h4>RSA Key Parameters</h4>
          <p>
            <label for="n">Modulus (hex):</label><br />
            <textarea
              id="n"
              name="n"
              rows="4"
              cols="70"
              placeholder="RSA modulus will appear here..."
            ></textarea>
          </p>

          <p>
            <label for="e">Public exponent (hex, F4=0x10001):</label><br />
            <input id="e" name="e" size="20" type="text" value="10001" />
          </p>

          <p>
            <label for="d">Private exponent (hex):</label><br />
            <textarea
              id="d"
              name="d"
              rows="4"
              cols="70"
              placeholder="Private exponent will appear here..."
            ></textarea>
          </p>

          <details>
            <summary>
              <strong>Advanced Key Parameters (Click to expand)</strong>
            </summary>
            <p>
              <label for="p">P (hex):</label><br />
              <textarea
                id="p"
                name="p"
                rows="2"
                cols="70"
                placeholder="Prime factor P will appear here..."
              ></textarea>
            </p>

            <p>
              <label for="q">Q (hex):</label><br />
              <textarea
                id="q"
                name="q"
                rows="2"
                cols="70"
                placeholder="Prime factor Q will appear here..."
              ></textarea>
            </p>

            <p>
              <label for="dmp1">D mod (P-1) (hex):</label><br />
              <textarea
                id="dmp1"
                name="dmp1"
                rows="2"
                cols="70"
                placeholder="D mod (P-1) will appear here..."
              ></textarea>
            </p>

            <p>
              <label for="dmq1">D mod (Q-1) (hex):</label><br />
              <textarea
                id="dmq1"
                name="dmq1"
                rows="2"
                cols="70"
                placeholder="D mod (Q-1) will appear here..."
              ></textarea>
            </p>

            <p>
              <label for="coeff">1/Q mod P (hex):</label><br />
              <textarea
                id="coeff"
                name="coeff"
                rows="2"
                cols="70"
                placeholder="Coefficient will appear here..."
              ></textarea>
            </p>
          </details>
        </div>
      </form>

      <!-- Instructions Section -->
      <div class="results">
        <h3>How to Use This Simulation</h3>
        <ol>
          <li>
            <strong>Enter your message:</strong> Type the text you want to
            encrypt in the plaintext field.
          </li>
          <li>
            <strong>Select or generate an RSA key:</strong> Choose a preset key
            or generate a new one with your desired bit length.
          </li>
          <li>
            <strong>Encrypt:</strong> Click the "ðŸ”’ Encrypt" button to encrypt
            your message using PKCS#1 v1.5 padding.
          </li>
          <li>
            <strong>Decrypt:</strong> Click the "ðŸ”“ Decrypt" button to decrypt
            the ciphertext back to the original message.
          </li>
        </ol>
        <p>
          <strong>Note:</strong> This simulation demonstrates PKCS#1 v1.5
          encryption/decryption using RSA. The padding scheme adds randomness
          and structure to ensure security.
        </p>
      </div>
    </div>

    <!-- JavaScript Files -->
    <script
      language="JavaScript"
      src="js/base64.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/jsbn.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/jsbn2.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/prng4.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/rng.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/rsa.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/rsa2.js"
      type="text/javascript"
    ></script>
    <script
      language="JavaScript"
      src="js/pkcs.js"
      type="text/javascript"
    ></script>
  </body>
</html>
